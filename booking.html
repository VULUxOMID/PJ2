<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Your Session - SubjectPhoto | Professional Photography Services</title>
    
    <!-- SEO Meta Tags -->
    <meta name="description" content="Book your professional photography session with SubjectPhoto. Choose from portraits, events, weddings, and more. Easy online booking with instant confirmation.">
    <meta name="keywords" content="photography booking, professional photographer booking, portrait session, event photography booking, wedding photographer booking">
    <meta name="author" content="SubjectPhoto">
    <meta name="robots" content="index, follow">
    
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Book Your Session - SubjectPhoto">
    <meta property="og:description" content="Book your professional photography session with SubjectPhoto. Easy online booking with instant confirmation.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://subjectphoto.com/booking.html">
    <meta property="og:image" content="https://images.unsplash.com/photo-1502920917128-1aa500764cbd?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80">
    
    <!-- Twitter Card Meta Tags -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="Book Your Session - SubjectPhoto">
    <meta name="twitter:description" content="Book your professional photography session with SubjectPhoto. Easy online booking with instant confirmation.">
    <meta name="twitter:image" content="https://images.unsplash.com/photo-1502920917128-1aa500764cbd?ixlib=rb-4.0.3&auto=format&fit=crop&w=1200&q=80">
    
    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ“·</text></svg>">
    
    <!-- Canonical URL -->
    <link rel="canonical" href="https://subjectphoto.com/booking.html">
    
    <!-- PWA Meta Tags -->
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#3b82f6">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="SubjectPhoto">
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'cool-white': '#f0f9ff',
                        'soft-white': '#e0f2fe',
                        'light-blue': '#f0f9ff',
                        'cool-gray': '#64748b',
                        'soft-gray': '#94a3b8',
                        'light-gray': '#e0f2fe',
                        'accent-blue': '#3b82f6',
                        'hover-blue': '#2563eb',
                        'success-green': '#10b981',
                        'warning-orange': '#f59e0b',
                        'error-red': '#ef4444'
                    },
                    fontFamily: {
                        'sans': ['Inter', 'system-ui', 'sans-serif']
                    }
                }
            }
        }
    </script>
    
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=GA_MEASUREMENT_ID"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'GA_MEASUREMENT_ID');
    </script>
    
    <!-- Structured Data -->
    <script type="application/ld+json">
    {
        "@context": "https://schema.org",
        "@type": "Service",
        "name": "Photography Booking",
        "description": "Book your professional photography session with SubjectPhoto",
        "provider": {
            "@type": "PhotographyBusiness",
            "name": "SubjectPhoto"
        },
        "areaServed": "San Francisco",
        "availableChannel": {
            "@type": "ServiceChannel",
            "serviceUrl": "https://subjectphoto.com/booking.html"
        }
    }
    </script>
</head>
<body class="bg-cool-white font-sans">
    <!-- Navigation -->
    <nav class="bg-white shadow-sm border-b border-light-gray">
        <div class="container mx-auto px-6">
            <div class="flex justify-between items-center py-4">
                <a href="index.html" class="text-2xl font-light text-slate-800">SubjectPhoto</a>
                <div class="hidden md:flex space-x-8">
                    <a href="index.html" class="text-cool-gray hover:text-accent-blue transition-colors font-medium">Home</a>
                    <a href="gallery.html" class="text-cool-gray hover:text-accent-blue transition-colors font-medium">Gallery</a>
                    <a href="about.html" class="text-cool-gray hover:text-accent-blue transition-colors font-medium">About</a>
                    <a href="booking.html" class="text-accent-blue font-medium">Book Now</a>
                </div>
                <button class="md:hidden text-cool-gray hover:text-accent-blue transition-colors" aria-label="Menu" aria-expanded="false" aria-controls="mobile-menu">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
                    </svg>
                </button>
            </div>
            <div id="mobile-menu" class="md:hidden hidden pb-4">
                <div class="flex flex-col space-y-4">
                    <a href="index.html" class="text-cool-gray hover:text-accent-blue transition-colors font-medium">Home</a>
                    <a href="gallery.html" class="text-cool-gray hover:text-accent-blue transition-colors font-medium">Gallery</a>
                    <a href="about.html" class="text-cool-gray hover:text-accent-blue transition-colors font-medium">About</a>
                    <a href="booking.html" class="text-accent-blue font-medium">Book Now</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- Hero Section -->
    <section class="py-20 bg-gradient-to-br from-soft-white to-light-blue">
        <div class="container mx-auto px-6 text-center">
            <h1 class="text-4xl sm:text-5xl md:text-6xl font-light mb-6 tracking-tight text-slate-800">
                Book Your Session
            </h1>
            <p class="text-lg sm:text-xl md:text-2xl text-cool-gray mb-12 max-w-3xl mx-auto leading-relaxed font-light">
                Ready to capture your special moments? Book your professional photography session today.
            </p>
        </div>
    </section>

    <!-- Booking Section -->
    <section class="py-16">
        <div class="container mx-auto px-6 max-w-6xl">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12">
                <!-- Booking Form -->
                <div class="bg-white rounded-xl border border-light-gray shadow-sm p-8">
                    <h2 class="text-2xl font-light mb-6 text-slate-800">Book Your Session</h2>
                    <form id="booking-form" class="space-y-6">
                        <!-- Personal Information -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="client-name" class="block text-sm font-medium mb-2 text-slate-700">Full Name *</label>
                                <input 
                                    type="text" 
                                    id="client-name" 
                                    required 
                                    aria-describedby="name-error"
                                    class="w-full bg-white border border-light-gray rounded-lg px-4 py-3 text-slate-700 focus:outline-none focus:border-accent-blue focus:ring-2 focus:ring-accent-blue/20 transition-colors" 
                                    placeholder="Your full name"
                                    autocomplete="name"
                                >
                                <div id="name-error" class="text-error-red text-sm mt-1 hidden"></div>
                            </div>
                            <div>
                                <label for="client-email" class="block text-sm font-medium mb-2 text-slate-700">Email *</label>
                                <input 
                                    type="email" 
                                    id="client-email" 
                                    required 
                                    aria-describedby="email-error"
                                    class="w-full bg-white border border-light-gray rounded-lg px-4 py-3 text-slate-700 focus:outline-none focus:border-accent-blue focus:ring-2 focus:ring-accent-blue/20 transition-colors" 
                                    placeholder="your@email.com"
                                    autocomplete="email"
                                >
                                <div id="email-error" class="text-error-red text-sm mt-1 hidden"></div>
                            </div>
                        </div>
                        
                        <div>
                            <label for="client-phone" class="block text-sm font-medium mb-2 text-slate-700">Phone Number</label>
                            <input 
                                type="tel" 
                                id="client-phone" 
                                aria-describedby="phone-error"
                                class="w-full bg-white border border-light-gray rounded-lg px-4 py-3 text-slate-700 focus:outline-none focus:border-accent-blue focus:ring-2 focus:ring-accent-blue/20 transition-colors" 
                                placeholder="(555) 123-4567"
                                autocomplete="tel"
                            >
                            <div id="phone-error" class="text-error-red text-sm mt-1 hidden"></div>
                        </div>

                        <!-- Service Selection -->
                        <div>
                            <label for="service-type" class="block text-sm font-medium mb-2 text-slate-700">Service Type *</label>
                            <select 
                                id="service-type" 
                                required 
                                aria-describedby="service-error"
                                class="w-full bg-white border border-light-gray rounded-lg px-4 py-3 text-slate-700 focus:outline-none focus:border-accent-blue focus:ring-2 focus:ring-accent-blue/20 transition-colors"
                            >
                                <option value="">Select a service</option>
                                <option value="portraits">Portrait Photography</option>
                                <option value="events">Event Photography</option>
                                <option value="weddings">Wedding Photography</option>
                                <option value="nature">Nature Photography</option>
                                <option value="architecture">Architecture Photography</option>
                                <option value="other">Other</option>
                            </select>
                            <div id="service-error" class="text-error-red text-sm mt-1 hidden"></div>
                        </div>

                        <!-- Date and Time Selection -->
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                            <div>
                                <label for="booking-date" class="block text-sm font-medium mb-2 text-slate-700">Preferred Date *</label>
                                <input 
                                    type="date" 
                                    id="booking-date" 
                                    required 
                                    aria-describedby="date-error"
                                    class="w-full bg-white border border-light-gray rounded-lg px-4 py-3 text-slate-700 focus:outline-none focus:border-accent-blue focus:ring-2 focus:ring-accent-blue/20 transition-colors"
                                >
                                <div id="date-error" class="text-error-red text-sm mt-1 hidden"></div>
                            </div>
                            <div>
                                <label for="booking-time" class="block text-sm font-medium mb-2 text-slate-700">Preferred Time *</label>
                                <select 
                                    id="booking-time" 
                                    required 
                                    aria-describedby="time-error"
                                    class="w-full bg-white border border-light-gray rounded-lg px-4 py-3 text-slate-700 focus:outline-none focus:border-accent-blue focus:ring-2 focus:ring-accent-blue/20 transition-colors"
                                >
                                    <option value="">Select time</option>
                                    <option value="09:00">9:00 AM</option>
                                    <option value="10:00">10:00 AM</option>
                                    <option value="11:00">11:00 AM</option>
                                    <option value="12:00">12:00 PM</option>
                                    <option value="13:00">1:00 PM</option>
                                    <option value="14:00">2:00 PM</option>
                                    <option value="15:00">3:00 PM</option>
                                    <option value="16:00">4:00 PM</option>
                                    <option value="17:00">5:00 PM</option>
                                    <option value="18:00">6:00 PM</option>
                                </select>
                                <div id="time-error" class="text-error-red text-sm mt-1 hidden"></div>
                            </div>
                        </div>

                        <!-- Session Duration -->
                        <div>
                            <label for="session-duration" class="block text-sm font-medium mb-2 text-slate-700">Session Duration</label>
                            <select 
                                id="session-duration" 
                                aria-describedby="duration-error"
                                class="w-full bg-white border border-light-gray rounded-lg px-4 py-3 text-slate-700 focus:outline-none focus:border-accent-blue focus:ring-2 focus:ring-accent-blue/20 transition-colors"
                            >
                                <option value="1">1 Hour</option>
                                <option value="2">2 Hours</option>
                                <option value="3">3 Hours</option>
                                <option value="4">4 Hours</option>
                                <option value="full-day">Full Day</option>
                            </select>
                            <div id="duration-error" class="text-error-red text-sm mt-1 hidden"></div>
                        </div>

                        <!-- Message -->
                        <div>
                            <label for="client-message" class="block text-sm font-medium mb-2 text-slate-700">Additional Details</label>
                            <textarea 
                                id="client-message" 
                                rows="4" 
                                aria-describedby="message-error"
                                class="w-full bg-white border border-light-gray rounded-lg px-4 py-3 text-slate-700 focus:outline-none focus:border-accent-blue focus:ring-2 focus:ring-accent-blue/20 transition-colors resize-none" 
                                placeholder="Tell us about your vision, location preferences, special requirements, or any questions you have..."
                            ></textarea>
                            <div id="message-error" class="text-error-red text-sm mt-1 hidden"></div>
                        </div>

                        <!-- Submit Button -->
                        <button 
                            type="submit" 
                            class="w-full bg-accent-blue text-white px-8 py-4 rounded-lg hover:bg-hover-blue transition-colors font-medium text-lg focus:outline-none focus:ring-2 focus:ring-accent-blue/20"
                            aria-describedby="submit-status"
                        >
                            Book My Session
                        </button>
                        <div id="submit-status" class="sr-only" aria-live="polite"></div>
                    </form>
                </div>

                <!-- Calendar and Availability -->
                <div class="space-y-8">
                    <!-- Calendar -->
                    <div class="bg-white rounded-xl border border-light-gray shadow-sm p-8">
                        <h3 class="text-xl font-light mb-6 text-slate-800">Availability Calendar</h3>
                        <div class="mb-4 flex justify-between items-center">
                            <button id="prev-month" class="text-accent-blue hover:text-hover-blue transition-colors p-2 rounded-lg hover:bg-light-blue">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                                </svg>
                            </button>
                            <h4 id="current-month" class="text-lg font-medium text-slate-800">December 2024</h4>
                            <button id="next-month" class="text-accent-blue hover:text-hover-blue transition-colors p-2 rounded-lg hover:bg-light-blue">
                                <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                                </svg>
                            </button>
                        </div>
                        <div id="calendar-grid" class="grid grid-cols-7 gap-1">
                            <!-- Calendar will be populated by JavaScript -->
                        </div>
                    </div>

                    <!-- Availability Legend -->
                    <div class="bg-white rounded-xl border border-light-gray shadow-sm p-6">
                        <h3 class="text-lg font-light mb-4 text-slate-800">Availability Status</h3>
                        <div class="space-y-2 text-sm">
                            <div class="flex items-center">
                                <div class="w-4 h-4 bg-success-green rounded mr-3"></div>
                                <span class="text-slate-700">Available</span>
                            </div>
                            <div class="flex items-center">
                                <div class="w-4 h-4 bg-error-red rounded mr-3"></div>
                                <span class="text-slate-700">Booked</span>
                            </div>
                            <div class="flex items-center">
                                <div class="w-4 h-4 bg-warning-orange rounded mr-3"></div>
                                <span class="text-slate-700">Limited Availability</span>
                            </div>
                            <div class="flex items-center">
                                <div class="w-4 h-4 bg-light-gray rounded mr-3"></div>
                                <span class="text-slate-700">Unavailable</span>
                            </div>
                        </div>
                    </div>

                    <!-- Booking Information -->
                    <div class="bg-white rounded-xl border border-light-gray shadow-sm p-6">
                        <h3 class="text-lg font-light mb-4 text-slate-800">Booking Information</h3>
                        <div class="space-y-3 text-sm text-cool-gray">
                            <p>â€¢ Sessions typically last 1-4 hours</p>
                            <p>â€¢ Please arrive 10 minutes early</p>
                            <p>â€¢ Cancellations require 24-hour notice</p>
                            <p>â€¢ Weather-dependent sessions may be rescheduled</p>
                            <p>â€¢ Payment is due upon booking confirmation</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Success Modal -->
    <div id="success-modal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center">
        <div class="bg-white rounded-xl p-8 max-w-md mx-4 max-h-[90vh] overflow-y-auto">
            <div class="text-center">
                <div class="w-16 h-16 bg-success-green rounded-full flex items-center justify-center mx-auto mb-4">
                    <svg class="w-8 h-8 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                </div>
                <h3 class="text-xl font-medium text-slate-800 mb-2">Booking Submitted!</h3>
                <p class="text-cool-gray mb-4">Your session request has been submitted successfully. We'll review it and confirm within 24 hours.</p>
                
                <div id="booking-details" class="bg-light-blue rounded-lg p-4 mb-6 text-left">
                    <h4 class="font-medium text-slate-800 mb-2">Booking Details:</h4>
                    <div id="booking-summary" class="text-sm text-cool-gray space-y-1">
                        <!-- Booking details will be populated here -->
                    </div>
                </div>
                
                <div class="bg-yellow-50 border border-yellow-200 rounded-lg p-4 mb-6">
                    <div class="flex items-start">
                        <svg class="w-5 h-5 text-yellow-600 mr-2 mt-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"></path>
                        </svg>
                        <div class="text-sm text-yellow-800">
                            <p class="font-medium">What happens next?</p>
                            <ul class="mt-1 space-y-1">
                                <li>â€¢ We'll review your booking request</li>
                                <li>â€¢ You'll receive a confirmation email within 24 hours</li>
                                <li>â€¢ We may contact you to discuss details</li>
                            </ul>
                        </div>
                    </div>
                </div>
                
                <div class="flex flex-col sm:flex-row gap-3">
                    <button onclick="closeSuccessModal()" class="flex-1 bg-accent-blue text-white px-6 py-3 rounded-lg hover:bg-hover-blue transition-colors font-medium">
                        Continue
                    </button>
                    <button onclick="printBookingConfirmation()" class="flex-1 bg-light-gray text-slate-700 px-6 py-3 rounded-lg hover:bg-gray-200 transition-colors font-medium">
                        <svg class="w-4 h-4 inline mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"></path>
                        </svg>
                        Print
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Footer -->
    <footer class="bg-white border-t border-light-gray py-12">
        <div class="container mx-auto px-6">
            <div class="text-center">
                <h3 class="text-2xl font-light mb-4 text-slate-800">SubjectPhoto</h3>
                <p class="text-cool-gray mb-6 font-light">Capturing Moments, Telling Stories</p>
                <div class="flex justify-center space-x-8 mb-8">
                    <a href="#" class="text-cool-gray hover:text-accent-blue transition-colors font-medium" onclick="shareOnSocial('instagram')">Instagram</a>
                    <a href="#" class="text-cool-gray hover:text-accent-blue transition-colors font-medium" onclick="shareOnSocial('facebook')">Facebook</a>
                    <a href="#" class="text-cool-gray hover:text-accent-blue transition-colors font-medium" onclick="shareOnSocial('twitter')">Twitter</a>
                    <a href="#" class="text-cool-gray hover:text-accent-blue transition-colors font-medium" onclick="shareOnSocial('linkedin')">LinkedIn</a>
                </div>
                <p class="text-soft-gray text-sm font-light">&copy; 2024 SubjectPhoto. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <!-- Service Worker Registration -->
    <script>
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(registration => {
                        console.log('SW registered: ', registration);
                    })
                    .catch(registrationError => {
                        console.log('SW registration failed: ', registrationError);
                    });
            });
        }
    </script>

    <style>
        /* Mobile-friendly calendar styles */
        @media (max-width: 768px) {
            #calendar-grid {
                gap: 2px;
            }
            
            #calendar-grid > div {
                min-height: 40px;
                display: flex;
                align-items: center;
                justify-content: center;
                font-size: 14px;
                padding: 8px 4px;
            }
            
            #calendar-grid > div:first-child {
                min-height: auto;
                padding: 8px 4px;
                font-weight: 600;
            }
        }
        
        /* Touch-friendly buttons */
        @media (max-width: 768px) {
            button, input[type="submit"] {
                min-height: 44px;
                min-width: 44px;
            }
            
            .filter-btn, .filter-booking-btn {
                padding: 12px 16px;
                font-size: 16px;
            }
        }
        
        /* Form improvements for mobile */
        @media (max-width: 768px) {
            .booking-form input,
            .booking-form select,
            .booking-form textarea {
                font-size: 16px; /* Prevents zoom on iOS */
            }
            
            .booking-form .grid {
                grid-template-columns: 1fr;
            }
        }
        
        /* Loading animation */
        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }
        
        .animate-spin {
            animation: spin 1s linear infinite;
        }
    </style>

    <!-- Booking System JavaScript -->
    <script>
        // Booking data storage
        let bookings = JSON.parse(localStorage.getItem('bookings') || '[]');
        let unavailableDates = JSON.parse(localStorage.getItem('unavailableDates') || '[]');
        let currentDate = new Date();
        let selectedDate = null;

        // Initialize calendar
        function initCalendar() {
            updateCalendar();
            setupCalendarNavigation();
        }

        // Update calendar display
        function updateCalendar() {
            const calendarGrid = document.getElementById('calendar-grid');
            const currentMonthEl = document.getElementById('current-month');
            
            // Clear previous calendar
            calendarGrid.innerHTML = '';
            
            // Set month/year display
            const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
            currentMonthEl.textContent = `${monthNames[currentDate.getMonth()]} ${currentDate.getFullYear()}`;
            
            // Get first day of month and number of days
            const firstDay = new Date(currentDate.getFullYear(), currentDate.getMonth(), 1);
            const lastDay = new Date(currentDate.getFullYear(), currentDate.getMonth() + 1, 0);
            const startDate = new Date(firstDay);
            startDate.setDate(startDate.getDate() - firstDay.getDay());
            
            // Create calendar header
            const daysOfWeek = ['Sun', 'Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat'];
            daysOfWeek.forEach(day => {
                const dayHeader = document.createElement('div');
                dayHeader.className = 'text-center text-sm font-medium text-cool-gray py-2';
                dayHeader.textContent = day;
                calendarGrid.appendChild(dayHeader);
            });
            
            // Create calendar days
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            for (let i = 0; i < 42; i++) {
                const date = new Date(startDate);
                date.setDate(startDate.getDate() + i);
                
                const dayElement = document.createElement('div');
                dayElement.className = 'text-center py-2 cursor-pointer rounded hover:bg-light-blue transition-colors';
                
                // Check if date is in current month
                if (date.getMonth() === currentDate.getMonth()) {
                    dayElement.textContent = date.getDate();
                    
                    // Check availability status
                    const dateStr = date.toISOString().split('T')[0];
                    const isBooked = bookings.some(booking => booking.date === dateStr);
                    const isUnavailable = unavailableDates.includes(dateStr);
                    const isPast = date < today;
                    
                    if (isPast) {
                        dayElement.className += ' text-soft-gray bg-light-gray';
                    } else if (isBooked) {
                        dayElement.className += ' text-white bg-error-red';
                    } else if (isUnavailable) {
                        dayElement.className += ' text-soft-gray bg-light-gray';
                    } else {
                        dayElement.className += ' text-slate-800 bg-success-green';
                        dayElement.onclick = () => selectDate(date);
                    }
                } else {
                    dayElement.className += ' text-soft-gray';
                }
                
                calendarGrid.appendChild(dayElement);
            }
        }

        // Setup calendar navigation
        function setupCalendarNavigation() {
            document.getElementById('prev-month').onclick = () => {
                currentDate.setMonth(currentDate.getMonth() - 1);
                updateCalendar();
            };
            
            document.getElementById('next-month').onclick = () => {
                currentDate.setMonth(currentDate.getMonth() + 1);
                updateCalendar();
            };
        }

        // Select date from calendar
        function selectDate(date) {
            selectedDate = date;
            document.getElementById('booking-date').value = date.toISOString().split('T')[0];
            
            // Highlight selected date
            const calendarDays = document.querySelectorAll('#calendar-grid > div');
            calendarDays.forEach(day => day.classList.remove('ring-2', 'ring-accent-blue'));
            
            // Find and highlight the selected day
            const dayElements = Array.from(calendarDays).slice(7); // Skip header
            const dayIndex = Math.floor((date.getTime() - new Date(currentDate.getFullYear(), currentDate.getMonth(), 1).getTime()) / (1000 * 60 * 60 * 24)) + new Date(currentDate.getFullYear(), currentDate.getMonth(), 1).getDay();
            if (dayElements[dayIndex]) {
                dayElements[dayIndex].classList.add('ring-2', 'ring-accent-blue');
            }
        }

        // Handle form submission
        document.getElementById('booking-form').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Show loading state
            const submitBtn = this.querySelector('button[type="submit"]');
            const originalText = submitBtn.innerHTML;
            submitBtn.innerHTML = '<svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Processing...';
            submitBtn.disabled = true;
            
            // Validate and sanitize input
            const validationResult = validateBookingForm();
            if (!validationResult.isValid) {
                showErrorMessage(validationResult.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
                return;
            }
            
            const formData = {
                id: generateBookingId(),
                name: sanitizeInput(document.getElementById('client-name').value),
                email: sanitizeInput(document.getElementById('client-email').value).toLowerCase(),
                phone: sanitizeInput(document.getElementById('client-phone').value),
                service: sanitizeInput(document.getElementById('service-type').value),
                date: document.getElementById('booking-date').value,
                time: document.getElementById('booking-time').value,
                duration: parseInt(document.getElementById('session-duration').value),
                message: sanitizeInput(document.getElementById('client-message').value),
                status: 'pending', // Changed to pending for admin approval
                createdAt: new Date().toISOString(),
                ipAddress: 'client-side', // Would be server-side in production
                userAgent: navigator.userAgent
            };
            
            // Check for double booking with better conflict detection
            const bookingConflict = checkBookingConflict(formData);
            if (bookingConflict.hasConflict) {
                showErrorMessage(bookingConflict.message);
                submitBtn.innerHTML = originalText;
                submitBtn.disabled = false;
                return;
            }
            
            // Simulate server processing delay
            setTimeout(() => {
                try {
                    // Add booking
                    bookings.push(formData);
                    localStorage.setItem('bookings', JSON.stringify(bookings));
                    
                    // Show success modal
                    document.getElementById('success-modal').classList.remove('hidden');
                    
                    // Populate booking details in the modal
                    const bookingSummary = document.getElementById('booking-summary');
                    bookingSummary.innerHTML = `
                        <p><strong>Booking ID:</strong> ${formData.id}</p>
                        <p><strong>Service:</strong> ${formData.service}</p>
                        <p><strong>Date:</strong> ${formData.date}</p>
                        <p><strong>Time:</strong> ${formData.time}</p>
                        <p><strong>Duration:</strong> ${formData.duration} hour(s)</p>
                        <p><strong>Email:</strong> ${formData.email}</p>
                        <p><strong>Phone:</strong> ${formData.phone || 'N/A'}</p>
                        <p><strong>Message:</strong> ${formData.message || 'N/A'}</p>
                        <p><strong>Status:</strong> ${formData.status}</p>
                        <p><strong>Submitted at:</strong> ${formData.createdAt}</p>
                    `;
                    
                    // Track booking event
                    if (typeof gtag !== 'undefined') {
                        gtag('event', 'booking_submitted', {
                            'event_category': 'booking',
                            'event_label': formData.service
                        });
                    }
                    
                } catch (error) {
                    showErrorMessage('Failed to save booking. Please try again.');
                    console.error('Booking error:', error);
                } finally {
                    submitBtn.innerHTML = originalText;
                    submitBtn.disabled = false;
                }
            }, 1000);
        });

        // Comprehensive form validation
        function validateBookingForm() {
            const name = document.getElementById('client-name').value.trim();
            const email = document.getElementById('client-email').value.trim();
            const phone = document.getElementById('client-phone').value.trim();
            const service = document.getElementById('service-type').value;
            const date = document.getElementById('booking-date').value;
            const time = document.getElementById('booking-time').value;
            const duration = document.getElementById('session-duration').value;
            
            // Name validation
            if (!name) {
                showErrorMessage('Please enter your full name.');
                return { isValid: false, message: 'Please enter your full name.' };
            }
            if (name.length < 2) {
                showErrorMessage('Name must be at least 2 characters long.');
                return { isValid: false, message: 'Name must be at least 2 characters long.' };
            }
            if (name.length > 100) {
                showErrorMessage('Name is too long. Please use a shorter name.');
                return { isValid: false, message: 'Name is too long. Please use a shorter name.' };
            }
            if (!/^[a-zA-Z\s\-'\.]+$/.test(name)) {
                showErrorMessage('Name contains invalid characters. Please use only letters, spaces, hyphens, and apostrophes.');
                return { isValid: false, message: 'Name contains invalid characters. Please use only letters, spaces, hyphens, and apostrophes.' };
            }
            
            // Email validation
            if (!email) {
                showErrorMessage('Please enter your email address.');
                return { isValid: false, message: 'Please enter your email address.' };
            }
            const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
            if (!emailRegex.test(email)) {
                showErrorMessage('Please enter a valid email address.');
                return { isValid: false, message: 'Please enter a valid email address.' };
            }
            
            // Phone validation (optional but if provided, must be valid)
            if (phone) {
                const phoneRegex = /^[\+]?[1-9][\d]{0,15}$/;
                const cleanPhone = phone.replace(/[\s\-\(\)]/g, '');
                if (!phoneRegex.test(cleanPhone)) {
                    showErrorMessage('Please enter a valid phone number.');
                    return { isValid: false, message: 'Please enter a valid phone number.' };
                }
            }
            
            // Service validation
            if (!service) {
                showErrorMessage('Please select a service type.');
                return { isValid: false, message: 'Please select a service type.' };
            }
            
            // Date validation
            if (!date) {
                showErrorMessage('Please select a date for your session.');
                return { isValid: false, message: 'Please select a date for your session.' };
            }
            
            const selectedDate = new Date(date);
            const today = new Date();
            today.setHours(0, 0, 0, 0);
            
            if (selectedDate < today) {
                showErrorMessage('Please select a future date.');
                return { isValid: false, message: 'Please select a future date.' };
            }
            
            // Time validation
            if (!time) {
                showErrorMessage('Please select a time for your session.');
                return { isValid: false, message: 'Please select a time for your session.' };
            }
            
            // Duration validation
            if (!duration || duration < 1) {
                showErrorMessage('Please select a valid session duration.');
                return { isValid: false, message: 'Please select a valid session duration.' };
            }
            
            return { isValid: true };
        }

        // Input sanitization
        function sanitizeInput(input) {
            if (typeof input !== 'string') return '';
            
            return input
                .trim()
                .replace(/[<>]/g, '') // Remove potential HTML tags
                .replace(/&/g, '&amp;')
                .replace(/"/g, '&quot;')
                .replace(/'/g, '&#x27;')
                .replace(/\//g, '&#x2F;');
        }

        // Generate unique booking ID
        function generateBookingId() {
            return 'BK' + Date.now() + Math.random().toString(36).substr(2, 9).toUpperCase();
        }

        // Check for booking conflicts
        function checkBookingConflict(newBooking) {
            const selectedDate = newBooking.date;
            const selectedTime = newBooking.time;
            const selectedDuration = newBooking.duration;
            
            // Check if date is unavailable
            if (unavailableDates.includes(selectedDate)) {
                return { hasConflict: true, message: 'This date is unavailable. Please select another date.' };
            }
            
            // Check for existing bookings on the same date
            const existingBookings = bookings.filter(booking => 
                booking.date === selectedDate && booking.status !== 'cancelled'
            );
            
            if (existingBookings.length === 0) {
                return { hasConflict: false };
            }
            
            // Check for time conflicts
            const newStartTime = new Date(`2000-01-01T${selectedTime}`);
            const newEndTime = new Date(newStartTime.getTime() + (selectedDuration * 60 * 60 * 1000));
            
            for (const existingBooking of existingBookings) {
                const existingStartTime = new Date(`2000-01-01T${existingBooking.time}`);
                const existingEndTime = new Date(existingStartTime.getTime() + (existingBooking.duration * 60 * 60 * 1000));
                
                // Check for overlap
                if (newStartTime < existingEndTime && newEndTime > existingStartTime) {
                    return { 
                        hasConflict: true, 
                        message: `This time slot conflicts with an existing booking. Please select a different time or date.` 
                    };
                }
            }
            
            return { hasConflict: false };
        }

        // Show error message
        function showErrorMessage(message) {
            // Create error message element
            const errorDiv = document.createElement('div');
            errorDiv.className = 'fixed top-4 right-4 bg-error-red text-white px-6 py-4 rounded-lg shadow-lg z-50 max-w-md';
            errorDiv.innerHTML = `
                <div class="flex items-center">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
                    </svg>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(errorDiv);
            
            // Remove after 5 seconds
            setTimeout(() => {
                errorDiv.remove();
            }, 5000);
        }

        // Show success message
        function showSuccessMessage(message) {
            const successDiv = document.createElement('div');
            successDiv.className = 'fixed top-4 right-4 bg-success-green text-white px-6 py-4 rounded-lg shadow-lg z-50 max-w-md';
            successDiv.innerHTML = `
                <div class="flex items-center">
                    <svg class="w-5 h-5 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                    </svg>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(successDiv);
            
            setTimeout(() => {
                successDiv.remove();
            }, 5000);
        }

        // Close success modal
        function closeSuccessModal() {
            document.getElementById('success-modal').classList.add('hidden');
        }

        // Social sharing function
        function shareOnSocial(platform) {
            const url = encodeURIComponent(window.location.href);
            const title = encodeURIComponent('Book Your Photography Session - SubjectPhoto');
            const description = encodeURIComponent('Book your professional photography session with SubjectPhoto. Easy online booking with instant confirmation.');
            
            let shareUrl = '';
            
            switch(platform) {
                case 'facebook':
                    shareUrl = `https://www.facebook.com/sharer/sharer.php?u=${url}`;
                    break;
                case 'twitter':
                    shareUrl = `https://twitter.com/intent/tweet?url=${url}&text=${title}&hashtags=photography,booking`;
                    break;
                case 'linkedin':
                    shareUrl = `https://www.linkedin.com/sharing/share-offsite/?url=${url}`;
                    break;
                case 'instagram':
                    alert('To share on Instagram, please copy the link and share it in your Instagram story or bio!');
                    return;
                default:
                    return;
            }
            
            window.open(shareUrl, '_blank', 'width=600,height=400');
        }

        // Print booking confirmation
        function printBookingConfirmation() {
            const printContent = document.getElementById('success-modal').innerHTML;
            const originalContent = document.body.innerHTML;
            document.body.innerHTML = printContent;
            window.print();
            document.body.innerHTML = originalContent;
            window.location.reload(); // Reload to restore scroll position and other elements
        }

        // Mobile menu toggle
        document.querySelector('button[aria-label="Menu"]').addEventListener('click', function() {
            const mobileMenu = document.getElementById('mobile-menu');
            const isExpanded = this.getAttribute('aria-expanded') === 'true';
            
            this.setAttribute('aria-expanded', !isExpanded);
            mobileMenu.classList.toggle('hidden');
        });

        // Initialize booking system
        document.addEventListener('DOMContentLoaded', function() {
            initCalendar();
            
            // Set minimum date to today
            const today = new Date().toISOString().split('T')[0];
            document.getElementById('booking-date').min = today;
        });
    </script>
</body>
</html> 